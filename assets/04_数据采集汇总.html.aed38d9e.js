import{_ as n,o as s,c as a,d as t}from"./app.10b344e9.js";const e={},p=t(`<h1 id="\u6570\u636E\u91C7\u96C6\u6C47\u603B" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u91C7\u96C6\u6C47\u603B" aria-hidden="true">#</a> \u6570\u636E\u91C7\u96C6\u6C47\u603B</h1><h2 id="\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#\u6982\u8FF0" aria-hidden="true">#</a> \u6982\u8FF0</h2><p>\u6309\u4E00\u5B9A\u7684\u6807\u51C6(\u6BD4\u5982\u5929)\u8FDB\u884C\u8F7B\u5EA6\u6C47\u603B\u3002\u4E00\u884C\u4FE1\u606F\u4EE3\u8868\u4E00\u4E2A\u4E3B\u9898\u5BF9\u8C61\u7684\u6C47\u603B\u884C\u4E3A</p><h2 id="\u4E1A\u52A1\u672F\u8BED" tabindex="-1"><a class="header-anchor" href="#\u4E1A\u52A1\u672F\u8BED" aria-hidden="true">#</a> \u4E1A\u52A1\u672F\u8BED</h2><div class="data_table"><table><thead><tr><th style="text-align:center;">\u5E8F\u53F7</th><th>\u672F\u8BED</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td style="text-align:center;">1</td><td>\u7528\u6237</td><td>\u7528\u6237\u4EE5\u8BBE\u5907\u4E3A\u5224\u65AD\u6807\u51C6,\u5728\u79FB\u52A8\u7EDF\u8BA1\u4E2D,\u6BCF\u4E2A\u72EC\u7ACB\u8BBE\u5907\u8BA4\u4E3A\u662F\u4E00\u4E2A\u72EC\u7ACB\u7528\u6237.Android \u7CFB\u7EDF\u6839\u636E IMEI \u53F7,IOS \u7CFB\u7EDF\u6839\u636E OpenUDID \u6765\u6807\u8BC6\u4E00\u4E2A\u72EC\u7ACB\u7528\u6237\uFF0C\u6BCF\u90E8\u624B\u673A\u4E00\u4E2A\u7528\u6237\u3002</td></tr><tr><td style="text-align:center;">2</td><td>\u65B0\u589E\u7528\u6237</td><td>\u9996\u6B21\u8054\u7F51\u4F7F\u7528\u5E94\u7528\u7684\u7528\u6237.\u5982\u679C\u4E00\u4E2A\u7528\u6237\u9996\u6B21\u6253\u5F00\u67D0 APP,\u90A3\u8FD9\u4E2A\u7528\u6237\u5B9A\u4E49\u4E3A\u65B0\u589E\u7528\u6237:\u5378\u8F7D\u518D\u5B89\u88C5\u7684\u8BBE\u5907,\u4E0D\u4F1A\u88AB\u7B97\u4F5C\u4E00\u6B21\u65B0\u589E.\u65B0\u589E\u7528\u6237\u5305\u62EC\u65E5\u65B0\u589E\u7528\u6237. \u5468\u65B0\u589E\u7528\u6237.\u6708\u65B0\u589E\u7528\u6237</td></tr><tr><td style="text-align:center;">3</td><td>\u6D3B\u8DC3\u7528\u6237</td><td>\u6253\u5F00\u5E94\u7528\u7684\u7528\u6237\u5373\u4E3A\u6D3B\u8DC3\u7528\u6237\uFF0C\u4E0D\u8003\u8651\u7528\u6237\u7684\u4F7F\u7528\u60C5\u51B5\u3002\u6BCF\u5929\u4E00\u53F0\u8BBE\u5907\u6253\u5F00\u591A\u6B21\u4F1A\u88AB\u8BA1\u4E3A\u4E00\u4E2A\u6D3B\u8DC3\u7528\u6237.</td></tr><tr><td style="text-align:center;">4</td><td>\u5468(\u6708) \u6D3B\u8DC3\u7528\u6237</td><td>\u67D0\u4E2A\u81EA\u7136\u5468(\u6708) \u5185\u542F\u52A8\u8FC7\u5E94\u7528\u7684\u7528\u6237\uFF0C\u8BE5\u5468(\u6708) \u5185\u7684\u591A\u6B21\u542F\u52A8\u53EA\u8BB0\u4E00\u4E2A\u6D3B\u8DC3\u7528\u6237\u3002</td></tr><tr><td style="text-align:center;">5</td><td>\u6708\u6D3B\u8DC3\u7387</td><td>\u6708\u6D3B\u8DC3\u7528\u6237\u4E0E\u622A\u6B62\u5230\u8BE5\u6708\u7D2F\u8BA1\u7684\u7528\u6237\u603B\u548C\u4E4B\u95F4\u7684\u6BD4\u4F8B\u3002</td></tr><tr><td style="text-align:center;">6</td><td>\u6C89\u9ED8\u7528\u6237</td><td>\u7528\u6237\u4EC5\u5728\u5B89\u88C5\u5F53\u5929(\u6B21\u65E5) \u542F\u52A8\u4E00\u6B21\uFF0C\u540E\u7EED\u65F6\u95F4\u65E0\u518D\u542F\u52A8\u884C\u4E3A\u3002\u8BE5\u6307\u6807\u53EF\u4EE5\u53CD\u6620\u65B0\u589E\u7528\u6237\u8D28\u91CF\u548C\u7528\u6237\u4E0E APP \u7684\u5339\u914D\u7A0B\u5EA6\u3002</td></tr><tr><td style="text-align:center;">7</td><td>\u7248\u672C\u5206\u5E03</td><td>\u4E0D\u540C\u7248\u672C\u7684\u5468\u5185\u5404\u5929\u65B0\u589E\u7528\u6237\u6570\uFF0C\u6D3B\u8DC3\u7528\u6237\u6570\u548C\u542F\u52A8\u6B21\u6570\u3002\u5229\u4E8E\u5224\u65AD APP \u5404\u4E2A\u7248\u672C\u4E4B\u95F4\u7684\u4F18\u52A3\u548C\u7528\u6237\u884C\u4E3A\u4E60\u60EF\u3002</td></tr><tr><td style="text-align:center;">8</td><td>\u672C\u5468\u56DE\u6D41\u7528\u6237</td><td>\u4E0A\u5468\u672A\u542F\u52A8\u8FC7\u5E94\u7528\uFF0C\u672C\u5468\u542F\u52A8\u4E86\u5E94\u7528\u7684\u7528\u6237\u3002</td></tr><tr><td style="text-align:center;">9</td><td>\u8FDE\u7EED n \u5468\u6D3B\u8DC3\u7528\u6237</td><td>\u8FDE\u7EED n \u5468\uFF0C\u6BCF\u5468\u81F3\u5C11\u542F\u52A8\u4E00\u6B21\u3002</td></tr><tr><td style="text-align:center;">10</td><td>\u5FE0\u8BDA\u7528\u6237</td><td>\u8FDE\u7EED\u6D3B\u8DC3 5 \u5468\u4EE5\u4E0A\u7684\u7528\u6237\u5C1A\u7845\u8C37\u5927\u6570\u636E\u9879\u76EE\u4E4B\u7535\u5546\u6570\u636E\u4ED3\u5E93\u7CFB\u7EDF</td></tr><tr><td style="text-align:center;">11</td><td>\u8FDE\u7EED\u6D3B\u8DC3\u7528\u6237</td><td>\u8FDE\u7EED 2 \u5468\u53CA\u4EE5\u4E0A\u6D3B\u8DC3\u7684\u7528\u6237</td></tr><tr><td style="text-align:center;">12</td><td>\u8FD1\u671F\u6D41\u5931\u7528\u6237</td><td>\u8FDE\u7EED n(\u5927\u4E8E 2 \u5468\u5C0F\u4E8E 4 \u5468)\u5468\u6CA1\u6709\u542F\u52A8\u5E94\u7528\u7684\u7528\u6237\u3002(\u7B2C n+1 \u5468\u6CA1\u6709\u542F\u52A8\u8FC7)</td></tr><tr><td style="text-align:center;">13</td><td>\u7559\u5B58\u7528\u6237</td><td>\u67D0\u6BB5\u65F6\u95F4\u5185\u7684\u65B0\u589E\u7528\u6237\uFF0C\u7ECF\u8FC7\u4E00\u6BB5\u65F6\u95F4\u540E\uFF0C\u4ECD\u7136\u4F7F\u7528\u5E94\u7528\u7684\u88AB\u8BA4\u4F5C\u662F\u7559\u5B58\u7528\u6237\uFF1B\u8FD9\u90E8\u5206\u7528\u6237\u5360\u5F53\u65F6\u65B0\u589E\u7528\u6237\u7684\u6BD4\u4F8B\u5373\u662F\u7559\u5B58\u7387\u3002</td></tr><tr><td style="text-align:center;">14</td><td>\u7528\u6237\u65B0\u9C9C\u5EA6</td><td>\u6BCF\u5929\u542F\u52A8\u5E94\u7528\u7684\u65B0\u8001\u7528\u6237\u6BD4\u4F8B\uFF0C\u5373\u65B0\u589E\u7528\u6237\u6570\u5360\u6D3B\u8DC3\u7528\u6237\u6570\u7684\u6BD4\u4F8B</td></tr><tr><td style="text-align:center;">15</td><td>\u5355\u6B21\u4F7F\u7528\u65F6\u957F</td><td>\u6BCF\u6B21\u542F\u52A8\u4F7F\u7528\u7684\u65F6\u95F4\u957F\u5EA6</td></tr><tr><td style="text-align:center;">16</td><td>\u65E5\u4F7F\u7528\u65F6\u957F</td><td>\u7D2F\u8BA1\u4E00\u5929\u5185\u7684\u4F7F\u7528\u65F6\u95F4\u957F\u5EA6</td></tr><tr><td style="text-align:center;">17</td><td>\u542F\u52A8\u6B21\u6570\u8BA1\u7B97\u6807\u51C6</td><td>IOS \u5E73\u53F0\u5E94\u7528\u9000\u5230\u540E\u53F0\u5C31\u7B97\u4E00\u6B21\u72EC\u7ACB\u7684\u542F\u52A8: Android \u5E73\u53F0\u6211\u4EEC\u89C4\u5B9A\uFF0C\u4E24\u6B21\u542F\u52A8\u4E4B\u95F4\u7684\u95F4\u9694\u5C0F\u4E8E 30 \u79D2</td></tr></tbody></table></div><h2 id="\u6570\u636E\u8868\u8BBE" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u8868\u8BBE" aria-hidden="true">#</a> \u6570\u636E\u8868\u8BBE</h2><h3 id="\u6BCF\u65E5\u8BBE\u5907\u884C\u4E3A" tabindex="-1"><a class="header-anchor" href="#\u6BCF\u65E5\u8BBE\u5907\u884C\u4E3A" aria-hidden="true">#</a> \u6BCF\u65E5\u8BBE\u5907\u884C\u4E3A</h3><p>\u6BCF\u65E5\u8BBE\u5907\u884C\u4E3A\uFF0C\u4E3B\u8981\u6309\u7167\u8BBE\u5907 id \u7EDF\u8BA1\u3002</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> dws_uv_detail_daycount<span class="token punctuation">;</span>
<span class="token keyword">create</span> external <span class="token keyword">table</span> dws_uv_detail_daycount
<span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">\`</span>mid_id<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u8BBE\u5907id&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>brand<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> \u2018\u624B\u673A\u54C1\u724C<span class="token string">&#39;,
    \`model\` string COMMENT \u2018\u624B\u673A\u578B\u53F7&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>login_count<span class="token punctuation">\`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6D3B\u8DC3\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>page_stats<span class="token punctuation">\`</span></span> array<span class="token operator">&lt;</span>struct<span class="token operator">&lt;</span>page_id:string<span class="token punctuation">,</span>page_count:<span class="token keyword">bigint</span><span class="token operator">&gt;&gt;</span>
<span class="token keyword">COMMENT</span> <span class="token string">&#39;\u9875\u9762\u8BBF\u95EE\u7EDF\u8BA1&#39;</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6BCF\u65E5\u8BBE\u5907\u884C\u4E3A\u8868&#39;</span>
partitioned <span class="token keyword">by</span><span class="token punctuation">(</span>dt string<span class="token punctuation">)</span>
stored <span class="token keyword">as</span> parquet
location <span class="token string">&#39;/warehouse/gmall/dws/dws_uv_detail_daycount&#39;</span>
tblproperties <span class="token punctuation">(</span><span class="token string">&quot;parquet.compression&quot;</span><span class="token operator">=</span><span class="token string">&quot;lzo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6BCF\u65E5\u4F1A\u5458\u884C\u4E3A" tabindex="-1"><a class="header-anchor" href="#\u6BCF\u65E5\u4F1A\u5458\u884C\u4E3A" aria-hidden="true">#</a> \u6BCF\u65E5\u4F1A\u5458\u884C\u4E3A</h3><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> dws_user_action_daycount<span class="token punctuation">;</span>
<span class="token keyword">create</span> external <span class="token keyword">table</span> dws_user_action_daycount
<span class="token punctuation">(</span>
    user_id string <span class="token keyword">comment</span> <span class="token string">&#39;\u7528\u6237 id&#39;</span><span class="token punctuation">,</span>
    login_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u767B\u5F55\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    cart_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u52A0\u5165\u8D2D\u7269\u8F66\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    order_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u4E0B\u5355\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    order_amount <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u4E0B\u5355\u91D1\u989D&#39;</span><span class="token punctuation">,</span>
    payment_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u652F\u4ED8\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    payment_amount <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u652F\u4ED8\u91D1\u989D&#39;</span><span class="token punctuation">,</span>
    order_detail_stats
    array<span class="token operator">&lt;</span>struct<span class="token operator">&lt;</span>sku_id:string<span class="token punctuation">,</span>sku_num:<span class="token keyword">bigint</span><span class="token punctuation">,</span>order_count:<span class="token keyword">bigint</span><span class="token punctuation">,</span>order_amount:de
cimal<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u4E0B\u5355\u660E\u7EC6\u7EDF\u8BA1&#39;</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6BCF\u65E5\u4F1A\u5458\u884C\u4E3A&#39;</span>
PARTITIONED <span class="token keyword">BY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">\`</span>dt<span class="token punctuation">\`</span></span> string<span class="token punctuation">)</span>
stored <span class="token keyword">as</span> parquet
location <span class="token string">&#39;/warehouse/gmall/dws/dws_user_action_daycount/&#39;</span>
tblproperties <span class="token punctuation">(</span><span class="token string">&quot;parquet.compression&quot;</span><span class="token operator">=</span><span class="token string">&quot;lzo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> dws_user_action_daycount<span class="token punctuation">;</span>
<span class="token keyword">create</span> external <span class="token keyword">table</span> dws_user_action_daycount
<span class="token punctuation">(</span>
    user_id string <span class="token keyword">comment</span> <span class="token string">&#39;\u7528\u6237 id&#39;</span><span class="token punctuation">,</span>
    login_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u767B\u5F55\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    cart_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u52A0\u5165\u8D2D\u7269\u8F66\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    order_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u4E0B\u5355\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    order_amount <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u4E0B\u5355\u91D1\u989D&#39;</span><span class="token punctuation">,</span>
    payment_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u652F\u4ED8\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    payment_amount <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u652F\u4ED8\u91D1\u989D&#39;</span><span class="token punctuation">,</span>
    order_detail_stats
    array<span class="token operator">&lt;</span>struct<span class="token operator">&lt;</span>sku_id:string<span class="token punctuation">,</span>sku_num:<span class="token keyword">bigint</span><span class="token punctuation">,</span>order_count:<span class="token keyword">bigint</span><span class="token punctuation">,</span>
    order_amount:<span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u4E0B\u5355\u660E\u7EC6\u7EDF\u8BA1&#39;</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6BCF\u65E5\u4F1A\u5458\u884C\u4E3A&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6BCF\u65E5\u5546\u54C1\u884C\u4E3A" tabindex="-1"><a class="header-anchor" href="#\u6BCF\u65E5\u5546\u54C1\u884C\u4E3A" aria-hidden="true">#</a> \u6BCF\u65E5\u5546\u54C1\u884C\u4E3A</h3><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> dws_sku_action_daycount<span class="token punctuation">;</span>
<span class="token keyword">create</span> external <span class="token keyword">table</span> dws_sku_action_daycount
<span class="token punctuation">(</span>
    sku_id string <span class="token keyword">comment</span> <span class="token string">&#39;sku_id&#39;</span><span class="token punctuation">,</span>
    order_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u88AB\u4E0B\u5355\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    order_num <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u88AB\u4E0B\u5355\u4EF6\u6570&#39;</span><span class="token punctuation">,</span>
    order_amount <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u88AB\u4E0B\u5355\u91D1\u989D&#39;</span><span class="token punctuation">,</span>
    payment_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u88AB\u652F\u4ED8\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    payment_num <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u88AB\u652F\u4ED8\u4EF6\u6570&#39;</span><span class="token punctuation">,</span>
    payment_amount <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u88AB\u652F\u4ED8\u91D1\u989D&#39;</span><span class="token punctuation">,</span>
    refund_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u88AB\u9000\u6B3E\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    refund_num <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u88AB\u9000\u6B3E\u4EF6\u6570&#39;</span><span class="token punctuation">,</span>
    refund_amount <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u88AB\u9000\u6B3E\u91D1\u989D&#39;</span><span class="token punctuation">,</span>
    cart_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u88AB\u52A0\u5165\u8D2D\u7269\u8F66\u6B21\u6570&#39;</span>
    favor_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u88AB\u6536\u85CF\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    appraise_good_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u597D\u8BC4\u6570&#39;</span><span class="token punctuation">,</span>
    appraise_mid_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u4E2D\u8BC4\u6570&#39;</span><span class="token punctuation">,</span>
    appraise_bad_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u5DEE\u8BC4\u6570&#39;</span><span class="token punctuation">,</span>
    appraise_default_count <span class="token keyword">bigint</span> <span class="token keyword">comment</span> <span class="token string">&#39;\u9ED8\u8BA4\u8BC4\u4EF7\u6570&#39;</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6BCF\u65E5\u5546\u54C1\u884C\u4E3A&#39;</span>
PARTITIONED <span class="token keyword">BY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">\`</span>dt<span class="token punctuation">\`</span></span> string<span class="token punctuation">)</span>
stored <span class="token keyword">as</span> parquet
location <span class="token string">&#39;/warehouse/gmall/dws/dws_sku_action_daycount/&#39;</span>
tblproperties <span class="token punctuation">(</span><span class="token string">&quot;parquet.compression&quot;</span><span class="token operator">=</span><span class="token string">&quot;lzo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6BCF\u65E5\u6D3B\u52A8\u7EDF\u8BA1" tabindex="-1"><a class="header-anchor" href="#\u6BCF\u65E5\u6D3B\u52A8\u7EDF\u8BA1" aria-hidden="true">#</a> \u6BCF\u65E5\u6D3B\u52A8\u7EDF\u8BA1</h3><p>\u5EFA\u8868\u8BED\u53E5</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> dws_activity_info_daycount<span class="token punctuation">;</span>
<span class="token keyword">create</span> external <span class="token keyword">table</span> dws_activity_info_daycount<span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">\`</span>id<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u7F16\u53F7&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>activity_name<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6D3B\u52A8\u540D\u79F0&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>activity_type<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6D3B\u52A8\u7C7B\u578B&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>start_time<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u5F00\u59CB\u65F6\u95F4&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>end_time<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u7ED3\u675F\u65F6\u95F4&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>create_time<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u521B\u5EFA\u65F6\u95F4&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>order_count<span class="token punctuation">\`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u4E0B\u5355\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>payment_count<span class="token punctuation">\`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u652F\u4ED8\u6B21\u6570&#39;</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> \u2018\u6BCF\u65E5\u6D3B\u52A8\u7EDF\u8BA1<span class="token string">&#39;
PARTITIONED BY (\`dt\` string)
stored as parquet
location &#39;</span><span class="token operator">/</span>warehouse<span class="token operator">/</span>gmall<span class="token operator">/</span>dws<span class="token operator">/</span>dws_activity_info_daycount<span class="token operator">/</span>&#39;
tblproperties <span class="token punctuation">(</span><span class="token string">&quot;parquet.compression&quot;</span><span class="token operator">=</span><span class="token string">&quot;lzo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5EFA\u8868\u8BED\u53E5</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> dws_activity_info_daycount<span class="token punctuation">;</span>
<span class="token keyword">create</span> external <span class="token keyword">table</span> dws_activity_info_daycount<span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">\`</span>id<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u7F16\u53F7&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>activity_name<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6D3B\u52A8\u540D\u79F0&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>activity_type<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6D3B\u52A8\u7C7B\u578B&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>start_time<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u5F00\u59CB\u65F6\u95F4&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>end_time<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u7ED3\u675F\u65F6\u95F4&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>create_time<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u521B\u5EFA\u65F6\u95F4&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>display_count<span class="token punctuation">\`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u66DD\u5149\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>order_count<span class="token punctuation">\`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u4E0B\u5355\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>order_amount<span class="token punctuation">\`</span></span> <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u4E0B\u5355\u91D1\u989D&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>payment_count<span class="token punctuation">\`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u652F\u4ED8\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>payment_amount<span class="token punctuation">\`</span></span> <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u652F\u4ED8\u91D1\u989D&#39;</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6BCF\u65E5\u6D3B\u52A8\u7EDF\u8BA1&#39;</span>
PARTITIONED <span class="token keyword">BY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">\`</span>dt<span class="token punctuation">\`</span></span> string<span class="token punctuation">)</span>
stored <span class="token keyword">as</span> parquet
location <span class="token string">&#39;/warehouse/gmall/dws/dws_activity_info_daycount/&#39;</span>
tblproperties <span class="token punctuation">(</span><span class="token string">&quot;parquet.compression&quot;</span><span class="token operator">=</span><span class="token string">&quot;lzo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6BCF\u65E5\u5730\u533A\u7EDF\u8BA1" tabindex="-1"><a class="header-anchor" href="#\u6BCF\u65E5\u5730\u533A\u7EDF\u8BA1" aria-hidden="true">#</a> \u6BCF\u65E5\u5730\u533A\u7EDF\u8BA1</h3><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> dws_area_stats_daycount<span class="token punctuation">;</span>
<span class="token keyword">create</span> external <span class="token keyword">table</span> dws_area_stats_daycount<span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">\`</span>id<span class="token punctuation">\`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u7F16\u53F7&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>province_name<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u7701\u4EFD\u540D\u79F0&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>area_code<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u5730\u533A\u7F16\u7801&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>iso_code<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;iso \u7F16\u7801&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>region_id<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u5730\u533A ID&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>region_name<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u5730\u533A\u540D\u79F0&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>login_count<span class="token punctuation">\`</span></span> string <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6D3B\u8DC3\u8BBE\u5907\u6570&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>order_count<span class="token punctuation">\`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u4E0B\u5355\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>order_amount<span class="token punctuation">\`</span></span> <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u4E0B\u5355\u91D1\u989D&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>payment_count<span class="token punctuation">\`</span></span> <span class="token keyword">bigint</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u652F\u4ED8\u6B21\u6570&#39;</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>payment_amount<span class="token punctuation">\`</span></span> <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u652F\u4ED8\u91D1\u989D&#39;</span>
<span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6BCF\u65E5\u5730\u533A\u7EDF\u8BA1\u8868&#39;</span>
PARTITIONED <span class="token keyword">BY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">\`</span>dt<span class="token punctuation">\`</span></span> string<span class="token punctuation">)</span>
stored <span class="token keyword">as</span> parquet
location <span class="token string">&#39;/warehouse/gmall/dws/dws_area_stats_daycount/&#39;</span>
tblproperties <span class="token punctuation">(</span><span class="token string">&quot;parquet.compression&quot;</span><span class="token operator">=</span><span class="token string">&quot;lzo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u5176\u5B83" tabindex="-1"><a class="header-anchor" href="#\u5176\u5B83" aria-hidden="true">#</a> \u5176\u5B83</h2><ul><li>\u7565</li></ul>`,23),o=[p];function c(i,l){return s(),a("div",null,o)}var d=n(e,[["render",c],["__file","04_\u6570\u636E\u91C7\u96C6\u6C47\u603B.html.vue"]]);export{d as default};
