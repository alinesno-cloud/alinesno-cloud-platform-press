import{_ as p,o,c as i,a as n,e,d as t,b as s,r as l}from"./app.88dfe64d.js";const c={},r=t('<h1 id="hudi-\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#hudi-\u5B89\u88C5" aria-hidden="true">#</a> Hudi \u5B89\u88C5</h1><h2 id="\u672C\u5185\u5BB9\u4F60\u5C06\u83B7\u5F97" tabindex="-1"><a class="header-anchor" href="#\u672C\u5185\u5BB9\u4F60\u5C06\u83B7\u5F97" aria-hidden="true">#</a> \u672C\u5185\u5BB9\u4F60\u5C06\u83B7\u5F97</h2><ul><li>\u5982\u4F55\u5728 centos7 \u670D\u52A1\u5668\u4E0A\u5B89\u88C5 hudi</li><li>\u5728 flinksql \u4E2D\u63A5\u6536 kafka \u6D88\u606F\uFF0C\u5E76\u5C06\u6D88\u606F\u5199\u5165 hudi \u8868</li></ul><h2 id="hudi-\u4F9D\u8D56\u7684\u73AF\u5883" tabindex="-1"><a class="header-anchor" href="#hudi-\u4F9D\u8D56\u7684\u73AF\u5883" aria-hidden="true">#</a> Hudi \u4F9D\u8D56\u7684\u73AF\u5883</h2><table><thead><tr><th>\u8F6F\u4EF6\u540D\u79F0</th><th>\u7248\u672C\u53F7</th><th>\u5907\u6CE8</th></tr></thead><tbody><tr><td>JDK</td><td>1.8.0_181</td><td>\u590D\u7528 CDH6.2.0 \u7684 JDK</td></tr><tr><td>SCALA</td><td>2.12.15</td><td></td></tr><tr><td>Flink</td><td>1.14.4</td><td></td></tr><tr><td>Hadoop \u96C6\u7FA4</td><td>3.0.0+cdh6.2.0</td><td>\u5B89\u88C5 CDH6.2.0 \u96C6\u7FA4\u53CA hdfs\u3001hive \u7B49\u5B9E\u4F8B</td></tr><tr><td>kafka</td><td>2.12-3.2.0</td><td></td></tr></tbody></table><h2 id="\u90E8\u7F72" tabindex="-1"><a class="header-anchor" href="#\u90E8\u7F72" aria-hidden="true">#</a> \u90E8\u7F72</h2><p>1\u3001\u767B\u5F55 https://repo.maven.apache.org/maven2/org/apache/hudi/hudi-flink1.14-bundle_2.12/0.11.0/\u4E0B\u8F7D</p>',7),u=s("\u200B "),d={href:"https://repo.maven.apache.org/maven2/org/apache/hudi/hudi-flink1.14-bundle_2.12/0.11.0/hudi-flink1.14-bundle_2.12-0.11.0.jar",target:"_blank",rel:"noopener noreferrer"},k=s("hudi-flink1.14-bundle_2.12-0.11.0.jar"),b=n("p",null,"2\u3001\u767B\u5F55https://repo1.maven.org/maven2/org/apache/flink/flink-connector-kafka_2.12/1.14.4/\uFF0C\u4E0B\u8F7D",-1),v=s("\u200B "),m={href:"https://repo1.maven.org/maven2/org/apache/flink/flink-connector-kafka_2.12/1.14.4/flink-connector-kafka_2.12-1.14.4.jar",target:"_blank",rel:"noopener noreferrer"},h=s("flink-connector-kafka_2.12-1.14.4.jar"),g=n("p",null,"3\u3001\u767B\u5F55https://repo1.maven.org/maven2/org/apache/flink/flink-sql-connector-kafka_2.12/1.14.4/\uFF0C\u4E0B\u8F7D",-1),f=s("\u200B "),q={href:"https://repo1.maven.org/maven2/org/apache/flink/flink-sql-connector-kafka_2.12/1.14.4/flink-sql-connector-kafka_2.12-1.14.4.jar",target:"_blank",rel:"noopener noreferrer"},y=s("flink-sql-connector-kafka_2.12-1.14.4.jar"),_=t(`<p>4\u3001\u5C06\u4E0B\u8F7D\u7684 3 \u4E2A jar \u5305\u4E0A\u4F20\u5230 Flink1.14.4 \u7684 lib \u76EE\u5F55</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@cdh-slave config<span class="token punctuation">]</span><span class="token comment"># cd /root/flink/flink-1.14.4/lib</span>
You have new mail <span class="token keyword">in</span> /var/spool/mail/root
<span class="token punctuation">[</span>root@cdh-slave lib<span class="token punctuation">]</span><span class="token comment"># ls -alt</span>
total <span class="token number">231872</span>
-rw-r--r--  <span class="token number">1</span> root root    <span class="token number">389154</span> Jun <span class="token number">13</span> <span class="token number">15</span>:34 flink-connector-kafka_2.12-1.14.4.jar
drwxr-xr-x  <span class="token number">2</span> lgb  <span class="token number">1001</span>      <span class="token number">4096</span> Jun <span class="token number">13</span> <span class="token number">15</span>:34 <span class="token builtin class-name">.</span>
-rw-r--r--  <span class="token number">1</span> root root   <span class="token number">3704559</span> Jun <span class="token number">13</span> <span class="token number">15</span>:34 flink-sql-connector-kafka_2.12-1.14.4.jar
drwxr-xr-x <span class="token number">12</span> lgb  <span class="token number">1001</span>      <span class="token number">4096</span> Jun <span class="token number">13</span> <span class="token number">15</span>:32 <span class="token punctuation">..</span>
-rw-r--r--  <span class="token number">1</span> root root  <span class="token number">47340482</span> Jun <span class="token number">10</span> <span class="token number">12</span>:16 hudi-flink1.14-bundle_2.12-0.11.0.jar
-rw-r--r--  <span class="token number">1</span> lgb  <span class="token number">1001</span> <span class="token number">136063964</span> Feb <span class="token number">25</span> <span class="token number">20</span>:49 flink-dist_2.12-1.14.4.jar
-rw-r--r--  <span class="token number">1</span> lgb  <span class="token number">1001</span>  <span class="token number">39635530</span> Feb <span class="token number">25</span> <span class="token number">20</span>:48 flink-table_2.12-1.14.4.jar
-rw-r--r--  <span class="token number">1</span> lgb  <span class="token number">1001</span>     <span class="token number">85584</span> Feb <span class="token number">25</span> <span class="token number">20</span>:46 flink-csv-1.14.4.jar
-rw-r--r--  <span class="token number">1</span> lgb  <span class="token number">1001</span>    <span class="token number">153145</span> Feb <span class="token number">25</span> <span class="token number">20</span>:45 flink-json-1.14.4.jar
-rw-r--r--  <span class="token number">1</span> lgb  <span class="token number">1001</span>    <span class="token number">208006</span> Jan <span class="token number">13</span> <span class="token number">19</span>:06 log4j-1.2-api-2.17.1.jar
-rw-r--r--  <span class="token number">1</span> lgb  <span class="token number">1001</span>    <span class="token number">301872</span> Jan  <span class="token number">7</span> <span class="token number">18</span>:07 log4j-api-2.17.1.jar
-rw-r--r--  <span class="token number">1</span> lgb  <span class="token number">1001</span>   <span class="token number">1790452</span> Jan  <span class="token number">7</span> <span class="token number">18</span>:07 log4j-core-2.17.1.jar
-rw-r--r--  <span class="token number">1</span> lgb  <span class="token number">1001</span>     <span class="token number">24279</span> Jan  <span class="token number">7</span> <span class="token number">18</span>:07 log4j-slf4j-impl-2.17.1.jar
-rw-r--r--  <span class="token number">1</span> lgb  <span class="token number">1001</span>   <span class="token number">7709731</span> Sep <span class="token number">10</span>  <span class="token number">2021</span> flink-shaded-zookeeper-3.4.14.jar
<span class="token punctuation">[</span>root@cdh-slave lib<span class="token punctuation">]</span><span class="token comment">#</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5\u3001\u914D\u7F6E\u73AF\u5883\u53D8\u91CF</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /etc
<span class="token function">vi</span> profile
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_HOME</span><span class="token operator">=</span>/opt/cloudera/parcels/CDH
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/java/jdk1.8.0_181-cloudera
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JRE_HOME</span><span class="token operator">=</span>/usr/java/jdk1.8.0_181-cloudera/jre
<span class="token builtin class-name">export</span> <span class="token assign-left variable">SCALA_HOME</span><span class="token operator">=</span>/usr/local/scala-2.12.15
<span class="token builtin class-name">export</span> <span class="token assign-left variable">FLINK_HOME</span><span class="token operator">=</span>/root/flink/flink-1.14.4
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_CONF_DIR</span><span class="token operator">=</span>/etc/hadoop/conf
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_CLASSPATH</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span>hadoop classpath<span class="token variable">\`</span></span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HBASE_CONF_DIR</span><span class="token operator">=</span>/etc/hbase/conf
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HIVE_HOME</span><span class="token operator">=</span>/opt/cloudera/parcels/CDH/lib/hive
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HIVE_CONF_DIR</span><span class="token operator">=</span>/etc/hive/conf
<span class="token builtin class-name">export</span> <span class="token assign-left variable">SPARK_HOME</span><span class="token operator">=</span>/opt/cloudera/parcels/CDH
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_HOME</span><span class="token operator">=</span>/opt/cloudera/parcels/CDH

<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$SCALA_HOME</span>/bin:<span class="token variable">$FLINK_HOME</span>/bin:<span class="token variable">$JRE_HOME</span>/bin:<span class="token variable">\${M2_HOME}</span>/bin:<span class="token variable">\${HIVE_HOME}</span>/bin:<span class="token punctuation">{</span>SPARK_HOME<span class="token punctuation">}</span>/bin:<span class="token punctuation">{</span>HADOOP_HOME<span class="token punctuation">}</span>/bin:<span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CLASSPATH</span><span class="token operator">=</span>.:<span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar:<span class="token variable">$SCALA_HOME</span>/lib:<span class="token variable">$FLINK_HOME</span>/lib:<span class="token variable">$JRE_HOME</span>/lib:<span class="token variable">$CLASSPATH</span>

\u4FDD\u5B58\u540E\uFF0C\u6267\u884Csource profile\uFF0C\u4F7F\u73AF\u5883\u53D8\u91CF\u751F\u6548
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u8C03\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u8C03\u8BD5" aria-hidden="true">#</a> \u8C03\u8BD5</h2><h3 id="\u542F\u52A8-flink-\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8-flink-\u96C6\u7FA4" aria-hidden="true">#</a> \u542F\u52A8 flink \u96C6\u7FA4</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cd /root/flink/flink-1.14.4/bin

--\u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF
export HADOOP_CLASSPATH=\`$HADOOP_HOME/bin/hadoop classpath\`

--\u542F\u52A8\u96C6\u7FA4
./start-cluster.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u5173\u505C\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#\u5173\u505C\u96C6\u7FA4" aria-hidden="true">#</a> \u5173\u505C\u96C6\u7FA4</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cd /root/flink/flink-1.14.4/bin
./stop-cluster.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u542F\u52A8-kafka-\u96C6\u7FA4" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8-kafka-\u96C6\u7FA4" aria-hidden="true">#</a> \u542F\u52A8 kafka \u96C6\u7FA4</h3><h4 id="\u542F\u52A8-kafka" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8-kafka" aria-hidden="true">#</a> \u542F\u52A8 kafka</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /root/flink/kafka_2.12-3.2.0/bin
<span class="token function">nohup</span> <span class="token function">sh</span> kafka-server-start.sh <span class="token punctuation">..</span>/config/server.properties <span class="token operator">&amp;</span> \u975E\u5B88\u62A4\u8FDB\u7A0B\u542F\u52A8\uFF0C\u5BB9\u6613\u5F02\u5E38\u6B7B\u4EA1\uFF1A

<span class="token function">nohup</span> <span class="token function">sh</span> kafka-server-start.sh -daemon <span class="token punctuation">..</span>/config/server.properties <span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span> \u5B88\u62A4\u8FDB\u7A0B\u542F\u52A8\uFF0C\u9632\u6B62\u5F02\u5E38\u6B7B\u4EA1\uFF1A
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u521B\u5EFA-topic" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFA-topic" aria-hidden="true">#</a> \u521B\u5EFA topic</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /root/flink/kafka_2.12-3.2.0/bin
./kafka-topics.sh --create --bootstrap-server <span class="token number">192.168</span>.17.147:9092 --replication-factor <span class="token number">1</span> --partitions <span class="token number">1</span> --topic flinktest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u67E5\u770B\u5F53\u524D-topic-\u5217\u8868" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u5F53\u524D-topic-\u5217\u8868" aria-hidden="true">#</a> \u67E5\u770B\u5F53\u524D topic \u5217\u8868</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /root/flink/kafka_2.12-3.2.0/bin
./kafka-topics.sh --list --bootstrap-server <span class="token number">192.168</span>.17.147:9092
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="topic-\u5220\u9664" tabindex="-1"><a class="header-anchor" href="#topic-\u5220\u9664" aria-hidden="true">#</a> topic \u5220\u9664</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /root/flink/kafka_2.12-3.2.0/bin
./kafka-topics.sh --delete --bootstrap-server <span class="token number">192.168</span>.17.147:9092  --topic flinktest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u4FEE\u6539-topic-\u7684-partition-\u6570" tabindex="-1"><a class="header-anchor" href="#\u4FEE\u6539-topic-\u7684-partition-\u6570" aria-hidden="true">#</a> \u4FEE\u6539 topic \u7684 partition \u6570</h4><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cd /root/flink/kafka_2.12-3.2.0/bin
./kafka-topics.sh --bootstrap-server 192.168.17.147:9092 --alter --topic flinktest --partitions 5
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u67E5\u770B-topic-\u7684\u6D88\u606F" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B-topic-\u7684\u6D88\u606F" aria-hidden="true">#</a> \u67E5\u770B topic \u7684\u6D88\u606F</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./kafka-topics.sh --describe --bootstrap-server <span class="token number">192.168</span>.17.147:9092
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="\u4F7F\u7528-kafka-console-producer-sh-\u547D\u4EE4\u5411-topic-flinktest-\u53D1\u9001\u6D88\u606F" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528-kafka-console-producer-sh-\u547D\u4EE4\u5411-topic-flinktest-\u53D1\u9001\u6D88\u606F" aria-hidden="true">#</a> \u4F7F\u7528 kafka-console-producer.sh \u547D\u4EE4\u5411 topic flinktest \u53D1\u9001\u6D88\u606F</h4><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cd /root/flink/kafka_2.12-3.2.0/bin
sh kafka-console-producer.sh --broker-list 192.168.17.146:9092 --topic flinktest
//\u751F\u4EA7\u7AEF\u53D1\u6D88\u606F
{&quot;tinyint0&quot;: 6, &quot;smallint1&quot;: 223, &quot;int2&quot;: 42999, &quot;bigint3&quot;: 429450, &quot;float4&quot;: 95.47324181659323, &quot;double5&quot;: 340.5755392968011,&quot;decimal6&quot;: 111.1111, &quot;boolean7&quot;: true,  &quot;char8&quot;: &quot;dddddd&quot;, &quot;varchar9&quot;: &quot;buy0&quot;, &quot;string10&quot;: &quot;buy1&quot;, &quot;timestamp11&quot;: &quot;2021-09-13 03:08:50.810&quot;}
{&quot;tinyint0&quot;: 7, &quot;smallint1&quot;: 224, &quot;int2&quot;: 43000, &quot;bigint3&quot;: 429451, &quot;float4&quot;: 95.47324181659324, &quot;double5&quot;: 340.5755392968012,&quot;decimal6&quot;: 111.1112, &quot;boolean7&quot;: true,  &quot;char8&quot;: &quot;ddddde&quot;, &quot;varchar9&quot;: &quot;buy1&quot;, &quot;string10&quot;: &quot;buy1&quot;, &quot;timestamp11&quot;: &quot;2021-09-13 03:08:50.812&quot;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u4F7F\u7528-kafka-console-consumer-sh-\u6D88\u8D39\u6D88\u606F" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528-kafka-console-consumer-sh-\u6D88\u8D39\u6D88\u606F" aria-hidden="true">#</a> \u4F7F\u7528 kafka-console-consumer.sh \u6D88\u8D39\u6D88\u606F</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /root/flink/kafka_2.12-3.2.0/bin
<span class="token function">sh</span> kafka-console-consumer.sh --bootstrap-server <span class="token number">192.168</span>.17.147:9092   --topic flinktest --from-beginning
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u542F\u52A8-flinksql" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8-flinksql" aria-hidden="true">#</a> \u542F\u52A8 flinksql</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /root/flink/flink-1.14.4/bin

--\u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_CLASSPATH</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span>$HADOOP_HOME/bin/hadoop classpath<span class="token variable">\`</span></span>

./sql-client.sh embedded -j /root/flink/flink-1.14.4/lib/hudi-flink1.14-bundle_2.12-0.11.0.jar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u65B0\u5EFA\u4E0E-kafka-\u5173\u8054\u7684\u8868" tabindex="-1"><a class="header-anchor" href="#\u65B0\u5EFA\u4E0E-kafka-\u5173\u8054\u7684\u8868" aria-hidden="true">#</a> \u65B0\u5EFA\u4E0E kafka \u5173\u8054\u7684\u8868</h4><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> kafkatest <span class="token punctuation">(</span>
   tinyint0 <span class="token keyword">TINYINT</span>
  <span class="token punctuation">,</span>smallint1 <span class="token keyword">SMALLINT</span>
  <span class="token punctuation">,</span>int2 <span class="token keyword">INT</span>
  <span class="token punctuation">,</span>bigint3 <span class="token keyword">BIGINT</span>
  <span class="token punctuation">,</span>float4 <span class="token keyword">FLOAT</span>
  <span class="token punctuation">,</span>double5 <span class="token keyword">DOUBLE</span>
  <span class="token punctuation">,</span>decimal6 <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
  <span class="token punctuation">,</span>boolean7 <span class="token keyword">BOOLEAN</span>
  <span class="token punctuation">,</span>char8 STRING
  <span class="token punctuation">,</span>varchar9 STRING
  <span class="token punctuation">,</span>string10 STRING
  <span class="token punctuation">,</span>timestamp11 STRING
<span class="token punctuation">)</span> <span class="token keyword">WITH</span> <span class="token punctuation">(</span>
    <span class="token string">&#39;connector&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;kafka&#39;</span><span class="token punctuation">,</span>   <span class="token comment">-- \u4F7F\u7528 kafka connector</span>
    <span class="token string">&#39;topic&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;flinktest&#39;</span><span class="token punctuation">,</span>   <span class="token comment">-- kafka topic\u540D\u79F0</span>
    <span class="token string">&#39;scan.startup.mode&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;earliest-offset&#39;</span><span class="token punctuation">,</span>  <span class="token comment">-- \u4ECE\u8D77\u59CB offset \u5F00\u59CB\u8BFB\u53D6</span>
    <span class="token string">&#39;properties.bootstrap.servers&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;192.168.17.146:9092&#39;</span><span class="token punctuation">,</span>  <span class="token comment">-- kafka broker \u5730\u5740</span>
    <span class="token string">&#39;properties.group.id&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;testgroup1&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;value.format&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;json&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;value.json.fail-on-missing-field&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;true&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;value.fields-include&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;ALL&#39;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u67E5\u8BE2\u8868" tabindex="-1"><a class="header-anchor" href="#\u67E5\u8BE2\u8868" aria-hidden="true">#</a> \u67E5\u8BE2\u8868</h4><p>\u5728 kafka \u751F\u4EA7\u7AEF\uFF0C\u53D1\u6D88\u606F\u540E\uFF0C\u53EF\u770B\u5230\u8868\u63A5\u6536\u5230\u7684\u6570\u636E</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//\u751F\u4EA7\u7AEF\u53D1\u6D88\u606F</span>
<span class="token punctuation">{</span><span class="token string-property property">&quot;tinyint0&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;smallint1&quot;</span><span class="token operator">:</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;int2&quot;</span><span class="token operator">:</span> <span class="token number">42999</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;bigint3&quot;</span><span class="token operator">:</span> <span class="token number">429450</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;float4&quot;</span><span class="token operator">:</span> <span class="token number">95.47324181659323</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;double5&quot;</span><span class="token operator">:</span> <span class="token number">340.5755392968011</span><span class="token punctuation">,</span><span class="token string-property property">&quot;decimal6&quot;</span><span class="token operator">:</span> <span class="token number">111.1111</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;boolean7&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token string-property property">&quot;char8&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dddddd&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;varchar9&quot;</span><span class="token operator">:</span> <span class="token string">&quot;buy0&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;string10&quot;</span><span class="token operator">:</span> <span class="token string">&quot;buy1&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;timestamp11&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-09-13 03:08:50.810&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string-property property">&quot;tinyint0&quot;</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;smallint1&quot;</span><span class="token operator">:</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;int2&quot;</span><span class="token operator">:</span> <span class="token number">43000</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;bigint3&quot;</span><span class="token operator">:</span> <span class="token number">429451</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;float4&quot;</span><span class="token operator">:</span> <span class="token number">95.47324181659324</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;double5&quot;</span><span class="token operator">:</span> <span class="token number">340.5755392968012</span><span class="token punctuation">,</span><span class="token string-property property">&quot;decimal6&quot;</span><span class="token operator">:</span> <span class="token number">111.1112</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;boolean7&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token string-property property">&quot;char8&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ddddde&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;varchar9&quot;</span><span class="token operator">:</span> <span class="token string">&quot;buy1&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;string10&quot;</span><span class="token operator">:</span> <span class="token string">&quot;buy1&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;timestamp11&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-09-13 03:08:50.812&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> kafkatest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="\u65B0\u5EFA\u4E0E-hudi-\u5173\u8054\u7684\u8868" tabindex="-1"><a class="header-anchor" href="#\u65B0\u5EFA\u4E0E-hudi-\u5173\u8054\u7684\u8868" aria-hidden="true">#</a> \u65B0\u5EFA\u4E0E hudi \u5173\u8054\u7684\u8868</h4><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> huditest<span class="token punctuation">(</span>
		  uuid <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		  name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		  age <span class="token keyword">INT</span><span class="token punctuation">,</span>
		  ts <span class="token keyword">TIMESTAMP</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		  <span class="token identifier"><span class="token punctuation">\`</span>partition<span class="token punctuation">\`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
		<span class="token punctuation">)</span>
		PARTITIONED <span class="token keyword">BY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">\`</span>partition<span class="token punctuation">\`</span></span><span class="token punctuation">)</span>
		<span class="token keyword">WITH</span> <span class="token punctuation">(</span>
			<span class="token string">&#39;connector&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;hudi&#39;</span><span class="token punctuation">,</span>
			<span class="token string">&#39;path&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;hdfs:///user/flink/hudi/huditest&#39;</span><span class="token punctuation">,</span>
			<span class="token string">&#39;table.type&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;MERGE_ON_READ&#39;</span> <span class="token comment">-- this creates a MERGE_ON_READ table, by default is COPY_ON_WRITE</span>
			<span class="token string">&#39;write.operation&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;upsert&#39;</span><span class="token punctuation">,</span>
			<span class="token string">&#39;hoodie.datasource.write.recordkey.field&#39;</span><span class="token operator">=</span> <span class="token string">&#39;uuid&#39;</span><span class="token punctuation">,</span>
			<span class="token string">&#39;write.precombine.field&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;ts&#39;</span><span class="token punctuation">,</span>
			<span class="token string">&#39;write.tasks&#39;</span><span class="token operator">=</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span>
			<span class="token string">&#39;compaction.tasks&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span>
			<span class="token string">&#39;compaction.async.enabled&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;true&#39;</span><span class="token punctuation">,</span>
			<span class="token string">&#39;compaction.trigger.strategy&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;num_commits&#39;</span><span class="token punctuation">,</span>
			<span class="token string">&#39;compaction.delta_commits&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;1&#39;</span>
		<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u63D2\u5165\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#\u63D2\u5165\u6570\u636E" aria-hidden="true">#</a> \u63D2\u5165\u6570\u636E</h4><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>        <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> huditest <span class="token keyword">VALUES</span>
		  <span class="token punctuation">(</span><span class="token string">&#39;id1&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Danny&#39;</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token keyword">TIMESTAMP</span> <span class="token string">&#39;1970-01-01 00:00:01&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;par1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> huditest <span class="token keyword">VALUES</span>
		  <span class="token punctuation">(</span><span class="token string">&#39;id2&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Stephen&#39;</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token keyword">TIMESTAMP</span> <span class="token string">&#39;1970-01-01 00:00:02&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;par1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> huditest <span class="token keyword">VALUES</span>
		  <span class="token punctuation">(</span><span class="token string">&#39;id3&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Julian&#39;</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token keyword">TIMESTAMP</span> <span class="token string">&#39;1970-01-01 00:00:03&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;par2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> huditest <span class="token keyword">VALUES</span>
		  <span class="token punctuation">(</span><span class="token string">&#39;id4&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Fabian&#39;</span><span class="token punctuation">,</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token keyword">TIMESTAMP</span> <span class="token string">&#39;1970-01-01 00:00:04&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;par2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> huditest <span class="token keyword">VALUES</span>
		  <span class="token punctuation">(</span><span class="token string">&#39;id5&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Sophia&#39;</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token keyword">TIMESTAMP</span> <span class="token string">&#39;1970-01-01 00:00:05&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;par3&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> huditest <span class="token keyword">VALUES</span>
		  <span class="token punctuation">(</span><span class="token string">&#39;id6&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Emma&#39;</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token keyword">TIMESTAMP</span> <span class="token string">&#39;1970-01-01 00:00:06&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;par3&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> huditest <span class="token keyword">VALUES</span>
		  <span class="token punctuation">(</span><span class="token string">&#39;id7&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Bob&#39;</span><span class="token punctuation">,</span><span class="token number">44</span><span class="token punctuation">,</span><span class="token keyword">TIMESTAMP</span> <span class="token string">&#39;1970-01-01 00:00:07&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;par4&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> huditest <span class="token keyword">VALUES</span>
		  <span class="token punctuation">(</span><span class="token string">&#39;id8&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Han&#39;</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token keyword">TIMESTAMP</span> <span class="token string">&#39;1970-01-01 00:00:08&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;par4&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u67E5\u770B-hudi-\u8868\u7684-hdfs-\u6587\u4EF6\u53D8\u5316" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B-hudi-\u8868\u7684-hdfs-\u6587\u4EF6\u53D8\u5316" aria-hidden="true">#</a> \u67E5\u770B hudi \u8868\u7684 hdfs \u6587\u4EF6\u53D8\u5316</h4><p>\u9A8C\u8BC1\u5728 hdfs \u4E2D\u65B0\u5EFA\u4E86 hudi \u8868\u5E76\u5199\u5165\u4E86\u76F8\u5E94\u7684\u6570\u636E</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>hadoop fs -ls hdfs:///user/flink/hudi/huditest
hadoop fs -ls hdfs:///user/flink/hudi/huditest/par1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,41);function x(A,E){const a=l("ExternalLinkIcon");return o(),i("div",null,[r,n("p",null,[u,n("a",d,[k,e(a)])]),b,n("p",null,[v,n("a",m,[h,e(a)])]),g,n("p",null,[f,n("a",q,[y,e(a)])]),_])}var T=p(c,[["render",x],["__file","04_ApacheHudi\u5B89\u88C5.html.vue"]]);export{T as default};
